# PayHub5 - Система управления закупками и платежами

![PayHub5](https://img.shields.io/badge/version-5.0.0-blue.svg)
![React](https://img.shields.io/badge/React-18.2-61dafb.svg)
![TypeScript](https://img.shields.io/badge/TypeScript-5.8-blue.svg)
![Vite](https://img.shields.io/badge/Vite-7.0-646cff.svg)
![License](https://img.shields.io/badge/license-Proprietary-red.svg)

## Оглавление

- [О системе](#о-системе)
- [Ключевые возможности](#ключевые-возможности)
- [Технологический стек](#технологический-стек)
- [Быстрый старт](#быстрый-старт)
- [Архитектура системы](#архитектура-системы)
- [Структура проекта](#структура-проекта)
- [Основные модули](#основные-модули)
- [Документация](#документация)
- [Команда разработки](#команда-разработки)
- [Поддержка](#поддержка)

## О системе

PayHub5 - это современная веб-платформа для управления закупками и платежами в строительных компаниях. Система автоматизирует процессы согласования счетов, управления платежами, контроля бюджетов и взаимодействия с контрагентами.

### Целевая аудитория

- Строительные компании
- Девелоперские организации  
- Управляющие компании
- Подрядные организации

### Решаемые задачи

- Автоматизация документооборота по закупкам
- Контроль и согласование платежей
- Управление бюджетами проектов
- Отслеживание сроков поставок
- Формирование аналитической отчетности
- Интеграция с бухгалтерскими системами

## Ключевые возможности

### 📋 Управление счетами
- Создание и редактирование счетов на оплату
- Загрузка скан-копий документов
- Автоматический расчет НДС
- Контроль сроков оплаты
- Отслеживание статусов согласования

### 💳 Обработка платежей
- Регистрация платежей по счетам
- Частичная оплата счетов
- Контроль остатков к оплате
- Банковская выверка
- История платежных операций

### 🔄 Гибкие процессы согласования
- Настраиваемые маршруты согласования
- Многоэтапное утверждение
- Параллельное и последовательное согласование
- Эскалация при задержках
- Уведомления участникам процесса

### 👥 Управление контрагентами
- База поставщиков и плательщиков
- Проверка ИНН контрагентов
- История взаимодействий
- Рейтинг надежности
- Контроль документов

### 🏗️ Проектный учет
- Привязка расходов к проектам
- Контроль бюджетов проектов
- Адресная программа
- Аналитика по проектам
- Прогнозирование расходов

### 📊 Отчетность и аналитика
- Оперативные дашборды
- Детализированные отчеты
- Экспорт в Excel
- Графики и диаграммы
- KPI показатели

### 🔐 Безопасность и контроль
- Ролевая модель доступа
- Двухфакторная аутентификация
- Журнал аудита действий
- Шифрование данных
- Резервное копирование

### 🎨 Персонализация
- Настраиваемые темы оформления
- Брендирование интерфейса
- Индивидуальные рабочие столы
- Настройка уведомлений
- Языковая локализация

## Технологический стек

### Frontend
- **React 18.2** - UI фреймворк
- **TypeScript 5.8** - типизированный JavaScript
- **Vite 7.0** - сборщик и dev-сервер
- **Ant Design 5.12** - библиотека компонентов
- **TanStack Query 5.0** - управление серверным состоянием
- **Zustand 4.4** - управление клиентским состоянием
- **React Router 6.20** - маршрутизация

### Backend
- **Supabase** - Backend-as-a-Service платформа
- **PostgreSQL** - основная база данных
- **PostgREST** - RESTful API для PostgreSQL
- **Realtime** - WebSocket подписки
- **Storage** - хранилище файлов

### Инструменты разработки
- **ESLint** - линтинг кода
- **Prettier** - форматирование кода
- **Day.js** - работа с датами
- **xlsx** - экспорт в Excel
- **React Hot Toast** - уведомления

## Быстрый старт

### Системные требования

- Node.js 18.0 или выше
- npm 9.0 или выше
- Git
- Современный браузер (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)

### Установка

1. Клонирование репозитория:
```bash
git clone https://github.com/your-org/payhub5.git
cd payhub5
```

2. Установка зависимостей:
```bash
npm install
```

3. Настройка переменных окружения:
```bash
cp .env.example .env
# Отредактируйте .env файл с вашими настройками
```

4. Запуск в режиме разработки:
```bash
npm run dev
```

Приложение будет доступно по адресу: http://localhost:3000

### Основные команды

```bash
npm run dev          # Запуск dev-сервера (порт 3000)
npm run build        # Сборка для production
npm run preview      # Предпросмотр production сборки
npm run lint         # Проверка кода ESLint
npm run lint:fix     # Автоисправление ошибок ESLint
npm run format       # Форматирование кода Prettier
npm run type-check   # Проверка типов TypeScript
```

## Архитектура системы

### Общая архитектура

```
┌─────────────────────────────────────────────────────────┐
│                     Клиентская часть                     │
│                    (React + TypeScript)                  │
├─────────────────────────────────────────────────────────┤
│                      API Gateway                         │
│                      (PostgREST)                         │
├─────────────────────────────────────────────────────────┤
│                    Бизнес-логика                        │
│              (PostgreSQL Functions & Triggers)           │
├─────────────────────────────────────────────────────────┤
│                     База данных                          │
│                     (PostgreSQL)                         │
├─────────────────────────────────────────────────────────┤
│                  Файловое хранилище                      │
│                   (Supabase Storage)                     │
└─────────────────────────────────────────────────────────┘
```

### Трехуровневая архитектура сервисов

1. **CRUD Layer** (`services/[domain]/crud.ts`)
   - Прямые вызовы Supabase API
   - Базовые операции с данными
   - Минимальная бизнес-логика

2. **Query Layer** (`services/[domain]/queries.ts`)
   - Обработка ошибок
   - Трансформация данных
   - Оптимизированные запросы

3. **Hook Layer** (`services/hooks/use[Domain].ts`)
   - React Query хуки
   - Кэширование данных
   - Real-time подписки
   - Оптимистичные обновления

### Управление состоянием

- **Серверное состояние**: TanStack Query с настраиваемым stale time
- **Клиентское состояние**: Zustand с immer middleware
- **Аутентификация**: Zustand store с localStorage персистенцией
- **Real-time обновления**: Supabase channels с автоматической инвалидацией кэша

## Структура проекта

```
payhub5/
├── src/                      # Исходный код приложения
│   ├── app/                  # Конфигурация приложения
│   │   ├── providers.tsx     # React провайдеры
│   │   └── router.tsx        # Маршрутизация
│   ├── assets/               # Статические ресурсы
│   ├── components/           # React компоненты
│   │   ├── layout/           # Компоненты макета
│   │   ├── ui/               # UI компоненты
│   │   └── forms/            # Формы и поля
│   ├── config/               # Конфигурационные файлы
│   ├── models/               # Модели данных и stores
│   ├── pages/                # Страницы приложения
│   │   ├── Dashboard/        # Главная панель
│   │   ├── Invoices/         # Управление счетами
│   │   ├── Payments/         # Управление платежами
│   │   ├── Admin/            # Администрирование
│   │   └── ...               # Другие страницы
│   ├── realtime/             # Real-time подписки
│   ├── services/             # Сервисный слой
│   │   ├── admin/            # Административные сервисы
│   │   ├── invoices/         # Сервисы счетов
│   │   ├── payments/         # Сервисы платежей
│   │   ├── contractors/      # Сервисы контрагентов
│   │   ├── projects/         # Сервисы проектов
│   │   └── hooks/            # React Query хуки
│   ├── styles/               # Глобальные стили
│   ├── types/                # TypeScript типы
│   └── utils/                # Утилиты и хелперы
├── docs/                     # Документация
├── public/                   # Публичные файлы
├── supabase/                 # Supabase конфигурация
│   └── schemas/              # SQL схемы
└── database/                 # Миграции БД
```

## Основные модули

### 🧾 Модуль счетов (Invoices)
- Создание и редактирование счетов
- Управление жизненным циклом счета
- Прикрепление документов
- Расчет НДС и итоговых сумм
- Контроль сроков поставки
- Интеграция с workflow

### 💰 Модуль платежей (Payments)
- Регистрация платежей
- Частичная оплата
- Банковская выверка
- История транзакций
- Статусная модель платежей
- Отчеты по платежам

### 🔄 Модуль согласования (Approvals)
- Настройка маршрутов согласования
- Многоэтапное утверждение
- Параллельное согласование
- Контроль сроков
- Эскалация и уведомления
- История согласований

### 👤 Модуль администрирования (Admin)
- Управление пользователями
- Настройка ролей и прав
- Конфигурация workflow
- Системные настройки
- Журнал аудита
- Управление темами

### 📊 Модуль отчетности (Reports)
- Оперативные дашборды
- Аналитические отчеты
- Экспорт данных
- Графическая визуализация
- KPI метрики
- Прогнозирование

### 🏢 Модуль контрагентов (Contractors)
- База контрагентов
- Проверка реквизитов
- История взаимодействий
- Документы контрагентов
- Рейтинги и оценки

### 🏗️ Модуль проектов (Projects)
- Управление проектами
- Бюджеты проектов
- Адресная программа
- Связь с расходами
- Отчетность по проектам

## Документация

### Основная документация
- [Бизнес-функции](docs/BUSINESS_FUNCTIONS.md) - Описание бизнес-процессов
- [Руководство пользователя](docs/USER_MANUAL.md) - Инструкции для пользователей
- [Техническая документация](docs/TECHNICAL_DOCUMENTATION.md) - Для разработчиков
- [Руководство по развертыванию](docs/DEPLOYMENT_GUIDE.md) - Инструкции по установке
- [API Reference](docs/API_REFERENCE.md) - Справочник по API

### Дополнительные материалы
- [Управление темами](docs/theme-management-system.md) - Система тем оформления
- [Оптимизация производительности](PERFORMANCE_OPTIMIZATION_REPORT.md)
- [Миграция тем](docs/THEME_MIGRATION_INSTRUCTIONS.md)
- [Архитектура backend](backend-architecture.md)

## Команда разработки

### Контакты для связи

**Техническая поддержка:**
- Email: support@payhub.ru
- Телефон: +7 (495) 123-45-67
- Telegram: @payhub_support

**Отдел разработки:**
- Email: dev@payhub.ru
- GitHub: https://github.com/payhub-team

## Поддержка

### Сообщение об ошибках
Если вы обнаружили ошибку, пожалуйста, создайте issue в репозитории с описанием:
- Шаги для воспроизведения
- Ожидаемое поведение
- Фактическое поведение
- Скриншоты (если применимо)
- Версия браузера и ОС

### Запрос новых функций
Для запроса новых функций создайте issue с меткой "enhancement" и опишите:
- Бизнес-кейс
- Предлагаемое решение
- Альтернативные варианты
- Приоритет функции

### Вклад в разработку
Мы приветствуем вклад в развитие проекта! Пожалуйста:
1. Форкните репозиторий
2. Создайте feature branch
3. Внесите изменения
4. Создайте pull request

## Лицензия

PayHub5 является проприетарным программным обеспечением. Все права защищены.

© 2025 PayHub Team. Все права защищены.

---

**Версия документа:** 1.0.0  
**Дата обновления:** 07.09.2025  
**Автор:** PayHub Development Team